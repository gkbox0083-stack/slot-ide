# P4-04 最終整合測試

## 目標 (Objective)

執行最終整合測試，確保所有功能正常運作，包括：
- 完整流程測試
- 各功能模組測試
- 效能測試
- 錯誤處理測試

---

## 範圍 (Scope)

測試範圍：
- 所有 Phase 1-4 功能
- 端到端流程
- 邊界情況

---

## 測試清單

### 1. 核心機制測試

#### 1.1 Symbol 系統
- [ ] 新增一般符號正確
- [ ] 新增 Wild 符號正確
- [ ] 新增 Scatter 符號正確
- [ ] 符號編輯正確儲存
- [ ] 符號刪除正確
- [ ] ngWeight/fgWeight 獨立設定

#### 1.2 Wild 結算
- [ ] Wild 替代一般符號正確
- [ ] Wild 不替代特殊符號（設定為 false 時）
- [ ] Wild 位置正確記錄
- [ ] 多 Wild 組合選最高分

#### 1.3 Free Spin
- [ ] Scatter 觸發 Free Spin 正確
- [ ] Free Spin 次數正確扣減
- [ ] Retrigger 正確延長次數
- [ ] Multiplier 正確計算獎金
- [ ] Free Spin 結束正確返回 NG

#### 1.4 Pool 系統
- [ ] NG Pool 使用 ngWeight 生成
- [ ] FG Pool 使用 fgWeight 生成
- [ ] Pool 不使用 appearanceWeight
- [ ] 盤面切換清空 Pool 正確

### 2. UI 測試

#### 2.1 佈局
- [ ] 三欄式佈局正確顯示
- [ ] 響應式佈局正常
- [ ] Tab 切換正常
- [ ] 底部統計區可收合

#### 2.2 Control Panel
- [ ] 數值設定 Tab 正常
- [ ] 視覺設定 Tab 正常
- [ ] Pool Tab 正常
- [ ] 各面板可展開/收合

#### 2.3 Game Control
- [ ] SPIN 按鈕正常
- [ ] SIM 按鈕正常
- [ ] AUTO SPIN 正常
- [ ] Betting Tab 正常
- [ ] Simulation Tab 正常
- [ ] History Tab 正常
- [ ] Free Spin Tab 正常

### 3. 用戶系統測試

#### 3.1 認證
- [ ] Google 登入正常
- [ ] 登出正常
- [ ] Auth 狀態正確更新

#### 3.2 模板管理
- [ ] 建立模板正常
- [ ] 讀取模板正常
- [ ] 更新模板正常
- [ ] 刪除模板正常

#### 3.3 訪客模式
- [ ] 訪客可使用 IDE
- [ ] 訪客無法儲存（有提示）
- [ ] 訪客無法匯出（有提示）

### 4. 進階功能測試

#### 4.1 Simulation
- [ ] 堆疊模式累加正確
- [ ] 比較模式並排顯示正確
- [ ] 進度顯示正確

#### 4.2 數值驗證
- [ ] 警示等級正確
- [ ] 實際 vs 理論對比正確
- [ ] 錯誤偵測正確

#### 4.3 深色模式
- [ ] 切換正常
- [ ] 偏好儲存正常
- [ ] 系統偏好跟隨正常

### 5. 效能測試

- [ ] 10,000 次 Simulation 無明顯延遲
- [ ] Pool Build 100 盤面 < 5 秒
- [ ] UI 切換無卡頓
- [ ] 記憶體使用穩定

### 6. 錯誤處理測試

- [ ] 網路斷線時有提示
- [ ] Firebase 錯誤有處理
- [ ] 無效輸入有驗證
- [ ] 無 console 錯誤

### 7. 端到端流程測試

#### 流程 1：訪客快速體驗
1. [ ] 訪問網站
2. [ ] 顯示 Default 模板
3. [ ] 調整 Symbol 設定
4. [ ] Build Pool
5. [ ] 執行 Spin
6. [ ] 查看結果
7. [ ] 嘗試儲存（提示登入）

#### 流程 2：用戶完整操作
1. [ ] Google 登入
2. [ ] 新建模板
3. [ ] 設定所有參數
4. [ ] Build Pool
5. [ ] 執行 Simulation
6. [ ] 查看統計
7. [ ] 儲存模板
8. [ ] 登出
9. [ ] 重新登入
10. [ ] 載入模板
11. [ ] 確認數據正確

#### 流程 3：Free Spin 完整流程
1. [ ] 設定 Scatter 符號
2. [ ] 設定 Free Spin 參數
3. [ ] Build Pool
4. [ ] Spin 直到觸發 Free Spin
5. [ ] 觀察 Free Spin 執行
6. [ ] 確認 Retrigger 正確
7. [ ] 確認 Multiplier 正確
8. [ ] 確認返回 NG 正確

---

## 測試報告模板

```markdown
# slot-ide V2 整合測試報告

## 測試日期：YYYY-MM-DD

## 測試環境
- OS: 
- Browser: 
- Node: 
- npm: 

## 測試結果摘要
- 通過: XX / YY
- 失敗: XX / YY
- 跳過: XX / YY

## 失敗項目
| 項目 | 預期結果 | 實際結果 | 嚴重度 |
|------|----------|----------|--------|
| ... | ... | ... | ... |

## 效能數據
- Simulation 10K: XXX ms
- Pool Build 100: XXX ms
- 記憶體使用: XXX MB

## 建議修復優先級
1. ...
2. ...

## 其他觀察
- ...
```

---

## 驗收條件 (Acceptance Criteria)

- [ ] 所有測試項目通過（或已知問題已記錄）
- [ ] 無 P0 級別的失敗
- [ ] 效能指標達標
- [ ] 測試報告已完成

---

## 輸出格式 (Output Format)

完成後提供：
1. 完整測試報告
2. 失敗項目修復建議
3. 效能測試截圖
4. 最終版本確認

